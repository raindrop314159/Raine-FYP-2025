function factor=f_cal_factor_v2
%(pollutant, baseline, window OPEN, CLOSE, 
% AC OFF, ON, air purifier/recirculation OFF, ON, IO)
ratemp=zeros(4,7,8);
%pollutant order: PM10, PM2.5, NO2, O3
%HOME
ratemp(1,:,1)=[0.73 0 -0.08 0 -0.02 0 -0.9];
ratemp(2,:,1)=[0.83 0 -0.11 0 -0.02 0 -0.12];
ratemp(3,:,1)=[0.86 0 -0.01 0 0.04 0 -0.03];
ratemp(4,:,1)=[0.57 0 -0.13 0 -0.10 0 -0.08];
%SCHOOL
ratemp(1,:,2)=[0.73 0 -0.08 -0.02 0 0 -0.09];
ratemp(2,:,2)=[0.83	0 -0.11	-0.02 0 0 -0.12];
ratemp(3,:,2)=[0.86	0 -0.01	0.04 0 0 -0.03];
ratemp(4,:,2)=[0.57	0 -0.13	-0.1 0 0 -0.08];
%OFFICE
ratemp(1,:,3)=[0.48	0.17 0 0 0 0 -0.18];
ratemp(2,:,3)=[0.5 0.16 0 0 0 0 -0.1];
ratemp(3,:,3)=[0.47 0.13 0 0 0 0 -0.10];
ratemp(4,:,3)=[0.56 0.12 0 0 0 0 -0.06];
%OTHER INDOOR
ratemp(1,:,4)=[0.73 0 -0.17 0 -0.04 0 -0.12];
ratemp(2,:,4)=[0.81 0 -0.16 0 -0.04 0 -0.09];
ratemp(3,:,4)=[0.74 0 -0.13 0 -0.05 0 -0.09];
ratemp(4,:,4)=[0.57 0 -0.12 0 0.04 0 -0.12];
%VEHICLE
ratemp(1,:,5)=[0.3 0.4 0 0.1 0 0.2 0];
ratemp(2,:,5)=[0.4 0.4 0 0.1 0 0.2 0];
ratemp(3,:,5)=[0.3 0.4 0 0.1 0 0 0.25];
ratemp(4,:,5)=[0.3 0.4 0 0.1 0 0.2 0];
%For OUTDOOR, all IR=1
ratemp(1,:,6)=[1 0 0 0 0 0 0];
ratemp(2,:,6)=[1 0 0 0 0 0 0];
ratemp(3,:,6)=[1 0 0 0 0 0 0];
ratemp(4,:,6)=[1 0 0 0 0 0 0];
%MTR
ratemp(1,:,7)=[0.317185 0.54269319 -0.05017371 0 0 0 0];
ratemp(2,:,7)=[0.490650715 0.454953048 -0.072630098 0 0 0 0];
ratemp(3,:,7)=[0.793656044 -0.020593411 0.024314284 0 0 0 0];
ratemp(4,:,7)=[0.518722999 0.126542285 0.039483276 0 0 0 0];
%BUS AND MINIBUS
ratemp(1,:,8)=[0.526821929 -0.196706514 0.196706514 0 0 0 0];
ratemp(2,:,8)=[0.537670218 -0.177647349 0.177647349 0 0 0 0];
ratemp(3,:,8)=[0.657504147 -0.305110001 0.305110001 0 0 0 0];
ratemp(4,:,8)=[0.463466388 0.108504293 -0.108504293 0 0 0 0];


%for i = minValue:maxValue
%Identify the ME from Praise.csv
 %   if Praise(exposure_parameter,i) 
  %  Window = Praise()

%Calculate all IRs
factor=zeros(4,2,2,2,8);
for i1=1:8
    for i2=1:2
        for i3=1:2
            for i4=1:2
                factor(:,i4,i3,i2,i1)=ratemp(:,1,i1)+ratemp(:,1+i4,i1)+ratemp(:,3+i3,i1)+ratemp(:,5+i2,i1);
            end
        end
    end
end

% %pollutant order: PM10, PM2.5, NO2, O3
% ratemp=zeros(4,2,2);
% %MTR
% ratemp(1,:,1)=[0.317185 0.54269319 -0.05017371];
% ratemp(2,:,1)=[0.490650715 0.454953048 -0.072630098];
% ratemp(3,:,1)=[0.793656044 -0.020593411 0.024314284];
% ratemp(4,:,1)=[0.518722999 0.126542285 0.039483276];
% %BUS AND MINIBUS
% ratemp(1,:,1)=[0.526821929 -0.196706514 0.196706514];
% ratemp(2,:,1)=[0.537670218 -0.177647349 0.177647349];
% ratemp(3,:,1)=[0.657504147 -0.305110001 0.305110001];
% ratemp(4,:,1)=[0.463466388 0.108504293 -0.108504293];

end